import{a as B,b as k,c as U}from"./chunk-YHHM66EA.js";import{a as ne}from"./chunk-FPO6YSUY.js";import{m as te}from"./chunk-EDYTMDV7.js";import{G as ee}from"./chunk-BRULYD2Q.js";import{c as oe,d as ae,e as ce,f as re,h as le,i as pe,j as se,k as ue,l as me,m as de,n as ge,o as _e,p as Ce}from"./chunk-BYPESI6U.js";import{Aa as v,Ba as C,C as P,Cb as j,D,Da as f,Ea as b,Fa as w,H as q,I as d,Ia as N,J as g,Ja as K,Lb as I,N as Q,Ra as s,Sa as u,V as o,W as h,_b as V,ca as y,e as T,ea as p,gb as X,ha as E,hb as Z,ia as O,ja as i,jc as ie,ka as c,kc as R,la as A,lb as $,pa as x,qa as S,ra as _,va as z,wa as G,x as M,xa as J,za as m}from"./chunk-R7KBA722.js";var Te=()=>({width:"25rem"}),fe=()=>({width:"100%"});function Oe(a,t){if(a&1&&(A(0,"i"),m(1)),a&2){let e=_(2);O(e.account.type.icon),o(),C(" ",e.account.type.name," ")}}function xe(a,t){if(a&1&&(A(0,"i"),m(1)),a&2){let e=t.$implicit;O(e.icon),o(),C(" ",e.name," ")}}function Me(a,t){if(a&1&&(i(0,"span",18),m(1),s(2,"translate"),c()),a&2){let e=t.$implicit;o(),v(u(2,1,e.label))}}function Pe(a,t){if(a&1){let e=x();i(0,"p-dialog",1),s(1,"translate"),S("visibleChange",function(n){d(e);let r=_();return g(r.visibleChange.emit(n))}),i(2,"div",2)(3,"div",3)(4,"app-label-wrapper",4),s(5,"translate"),i(6,"input",5),w("ngModelChange",function(n){d(e);let r=_();return b(r.account.name,n)||(r.account.name=n),g(n)}),c()(),i(7,"p-colorPicker",6),w("ngModelChange",function(n){d(e);let r=_();return b(r.account.color,n)||(r.account.color=n),g(n)}),c()(),i(8,"app-label-wrapper",7),s(9,"translate"),i(10,"p-dropdown",8),w("ngModelChange",function(n){d(e);let r=_();return b(r.account.type,n)||(r.account.type=n),g(n)}),y(11,Oe,2,3,"ng-template",9)(12,xe,2,3,"ng-template",10),c()(),i(13,"app-label-wrapper",4),s(14,"translate"),i(15,"p-inputNumber",11),w("ngModelChange",function(n){d(e);let r=_();return b(r.account.balance,n)||(r.account.balance=n),g(n)}),c()(),i(16,"app-label-wrapper",4),s(17,"translate"),i(18,"app-dropdown-currency",12),w("valueChange",function(n){d(e);let r=_();return b(r.account.currency,n)||(r.account.currency=n),g(n)}),c()(),i(19,"app-label-wrapper",7),s(20,"translate"),i(21,"p-selectButton",13),w("ngModelChange",function(n){d(e);let r=_();return b(r.account.showInStats,n)||(r.account.showInStats=n),g(n)}),y(22,Me,3,3,"ng-template",14),c()(),i(23,"div",15)(24,"p-button",16),s(25,"translate"),S("onClick",function(){d(e);let n=_();return g(n.visibleChange.emit(!1))}),c(),i(26,"p-button",17),s(27,"translate"),S("onClick",function(){d(e);let n=_();return g(n.onSave())}),c()()()()}if(a&2){let e=_();E(N(53,Te)),p("header",u(1,37,e.account.id?"ACCOUNTS.UPDATE_HEADER":"ACCOUNTS.CREATE_HEADER"))("modal",!0)("visible",e.visible),o(4),p("label",u(5,39,"ACCOUNTS.PROPERTY_NAME"))("required",!0)("error",e.errors.name),o(2),f("ngModel",e.account.name),o(),f("ngModel",e.account.color),o(),p("label",u(9,41,"ACCOUNTS.PROPERTY_TYPE"))("error",e.errors.type),o(2),E(N(54,fe)),p("options",e.accountTypes),f("ngModel",e.account.type),p("placeholder","Select an account Type"),o(3),p("label",u(14,43,"ACCOUNTS.PROPERTY_BALANCE"))("required",!0)("error",e.errors.balance),o(2),E(N(55,fe)),f("ngModel",e.account.balance),p("minFractionDigits",2)("maxFractionDigits",2),o(),p("label",u(17,45,"ACCOUNTS.PROPERTY_CURRENCY"))("required",!0)("error",e.errors.currency),o(2),p("disabled",e.account.id),f("value",e.account.currency),o(),p("label",u(20,47,"ACCOUNTS.PROPERTY_SHOW_IN_STATS"))("error",e.errors.showInStats),o(2),p("options",e.yesNoOptions),f("ngModel",e.account.showInStats),o(3),p("label",u(25,49,"ACCOUNTS.CANCEL")),o(2),p("label",u(27,51,"ACCOUNTS.SAVE"))("loading",e.isSaveLoading)}}var W=class a{constructor(t,e,l){this.auth=t;this.accountsService=e;this.settingsService=l;this.subscribeSettings()}account;visible=!1;visibleChange=new Q;accountTypes=B;yesNoOptions=[{label:"ACCOUNTS.SHOW_IN_STATS_YES",value:!0},{label:"ACCOUNTS.SHOW_IN_STATS_NO",value:!1}];settings;errors={};isSaveLoading=!1;subSink=[];ngOnChanges(t){t.visible&&t.visible.currentValue&&!this.account&&this.prepareNewAccountTemplate()}subscribeSettings=()=>{let t=this.settingsService.settings$.subscribe(e=>{this.settings=e});this.subSink.push(t)};prepareNewAccountTemplate=()=>{!this.auth.currentUser||!this.settings||(this.account=new k(this.auth.currentUser.uid,{currency:this.settings.currency}))};onSave=()=>T(this,null,function*(){if(!this.account)return;let{isValid:t,errors:e}=this.account.validate();if(!t){this.errors=e;return}this.isSaveLoading=!0,(yield this.account.id?this.accountsService.editAccount(this.account):this.accountsService.createAccount(this.account))&&this.visibleChange.emit(!1),this.isSaveLoading=!1});ngOnDestroy(){this.subSink.forEach(t=>t.unsubscribe())}static \u0275fac=function(e){return new(e||a)(h(ee),h(U),h(te))};static \u0275cmp=P({type:a,selectors:[["app-dialog-account-details"]],inputs:{account:"account",visible:"visible"},outputs:{visibleChange:"visibleChange"},features:[q],decls:1,vars:1,consts:[["class","new-account-dialog",3,"style","header","modal","visible","visibleChange",4,"ngIf"],[1,"new-account-dialog",3,"visibleChange","header","modal","visible"],[1,"new-account-dialog-wrapper"],[1,"two-column-wrapper"],[3,"label","required","error"],["pInputText","",3,"ngModelChange","ngModel"],[1,"big-color-picker",3,"ngModelChange","ngModel"],[3,"label","error"],[3,"ngModelChange","options","ngModel","placeholder"],["pTemplate","selectedItem"],["pTemplate","item"],["mode","decimal",3,"ngModelChange","ngModel","minFractionDigits","maxFractionDigits"],["placeholder","Currency",3,"valueChange","disabled","value"],["optionValue","value",3,"ngModelChange","options","ngModel"],["pTemplate",""],[1,"actions-wrapper"],["severity","secondary",3,"onClick","label"],[3,"onClick","label","loading"],[1,"p-button-label"]],template:function(e,l){e&1&&y(0,Pe,28,56,"p-dialog",0),e&2&&p("ngIf",l.account)},dependencies:[X,oe,ae,ce,R,V,le,se,ue,re,de,ge,pe,_e,I],styles:[".new-account-dialog[_ngcontent-%COMP%]     .p-dialog-content{overflow:visible}.new-account-dialog[_ngcontent-%COMP%]     .p-dialog-content .new-account-dialog-wrapper{display:flex;flex-direction:column;align-items:stretch;gap:8px}.new-account-dialog[_ngcontent-%COMP%]     .p-dialog-content .new-account-dialog-wrapper .two-column-wrapper{display:flex;align-items:center;gap:8px}.new-account-dialog[_ngcontent-%COMP%]     .p-dialog-content .new-account-dialog-wrapper .two-column-wrapper>*{flex-grow:1}.new-account-dialog[_ngcontent-%COMP%]     .p-dialog-content .new-account-dialog-wrapper .two-column-wrapper .big-color-picker{flex-grow:0;align-self:flex-start;margin-top:calc(var(--font-size) + .75rem)}.new-account-dialog[_ngcontent-%COMP%]     .p-dialog-content .new-account-dialog-wrapper .two-column-wrapper .big-color-picker input{width:2rem;height:2rem}.new-account-dialog[_ngcontent-%COMP%]     .p-dialog-content .new-account-dialog-wrapper .actions-wrapper{display:flex;align-items:center;justify-content:flex-end;gap:8px}"]})};var Ee=["accountsTable"],Ne=a=>({"background-color":a});function Ie(a,t){a&1&&(i(0,"tr")(1,"th",9),m(2),s(3,"translate"),c(),i(4,"th",10),m(5),s(6,"translate"),c(),i(7,"th",11),m(8),s(9,"translate"),c(),i(10,"th"),m(11),s(12,"translate"),c(),i(13,"th",12),m(14),s(15,"translate"),c(),i(16,"th",12),m(17),s(18,"translate"),c()()),a&2&&(o(2),C(" ",u(3,6,"ACCOUNTS.PROPERTY_NAME")," "),o(3),C(" ",u(6,8,"ACCOUNTS.PROPERTY_TYPE")," "),o(3),C(" ",u(9,10,"ACCOUNTS.PROPERTY_BALANCE")," "),o(3),v(u(12,12,"ACCOUNTS.PROPERTY_CURRENCY")),o(3),C(" ",u(15,14,"ACCOUNTS.PROPERTY_SHOW_IN_STATS")," "),o(3),C(" ",u(18,16,"ACCOUNTS.PROPERTY_ACTIONS")," "))}function Ve(a,t){if(a&1){let e=x();i(0,"tr")(1,"td")(2,"div",13),A(3,"div",14),i(4,"span"),m(5),c()()(),i(6,"td"),A(7,"i"),m(8),c(),i(9,"td",11),m(10),s(11,"number"),c(),i(12,"td"),m(13),c(),i(14,"td",12),m(15),s(16,"translate"),c(),i(17,"td")(18,"div",13)(19,"button",15),S("click",function(){let n=d(e).$implicit,r=_();return g(r.editAccount(n))}),c(),i(20,"button",16),S("click",function(){let n=d(e).$implicit,r=_();return g(r.deleteAccount(n))}),c()()()()}if(a&2){let e=t.$implicit;o(3),p("ngStyle",K(12,Ne,e.color)),o(2),v(e.name),o(2),O(e.type.icon),o(),C(" ",e.type.name,""),o(2),v(u(11,8,e.balance)),o(3),v(e.currency.short),o(2),C(" ",u(16,10,e.showInStats?"ACCOUNTS.SHOW_IN_STATS_YES":"ACCOUNTS.SHOW_IN_STATS_NO")," ")}}var Y=class a{constructor(t,e){this.accountsService=t;this.confirmDialogService=e;this.subscribeAccounts()}accountsTable;accountTypes=B;accounts=[];editingAccount;isNewAccountDialogVisible=!1;subSink=[];ngOnInit(){this.subscribeAccounts()}subscribeAccounts=()=>{let t=this.accountsService.accounts$.subscribe(e=>{this.accounts=e});this.subSink.push(t)};onNewClick=()=>T(this,null,function*(){delete this.editingAccount,this.isNewAccountDialogVisible=!0});editAccount=t=>{t.id&&(this.editingAccount=new k(t.uid,t),this.isNewAccountDialogVisible=!0)};deleteAccount=t=>T(this,null,function*(){(yield this.confirmDialogService.danger("ACCOUNTS.DELETE_CONFIRM_TITLE","ACCOUNTS.DELETE_CONFIRM_MESSAGE","pi pi-trash"))&&this.onDeleteConfirmed(t)});onDeleteConfirmed=t=>{t.id&&this.accountsService.deleteAccount(t.id)};ngOnDestroy(){this.subSink.forEach(t=>t.unsubscribe())}static \u0275fac=function(e){return new(e||a)(h(U),h(ne))};static \u0275cmp=P({type:a,selectors:[["app-accounts"]],viewQuery:function(e,l){if(e&1&&z(Ee,5),e&2){let n;G(n=J())&&(l.accountsTable=n.first)}},decls:9,vars:4,consts:[["accountsTable",""],[1,"accounts-container"],[1,"actions-wrapper"],["icon","pi pi-plus",3,"onClick"],[1,"accounts-table-wrapper"],["scrollHeight","flex",1,"accounts-table",3,"scrollable","value"],["pTemplate","header"],["pTemplate","body"],[3,"visibleChange","account","visible"],[2,"width","30%"],[2,"width","20%"],[1,"align-right"],[1,"align-center"],[1,"cell-flex-wrapper"],[1,"p-inputtext","p-colorpicker-preview",3,"ngStyle"],["pButton","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","type","button","icon","pi pi-trash",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"]],template:function(e,l){if(e&1){let n=x();i(0,"div",1)(1,"div",2)(2,"p-button",3),S("onClick",function(){return d(n),g(l.onNewClick())}),c()(),i(3,"div",4)(4,"p-table",5,0),y(6,Ie,19,18,"ng-template",6)(7,Ve,21,14,"ng-template",7),c()()(),i(8,"app-dialog-account-details",8),w("visibleChange",function(F){return d(n),b(l.isNewAccountDialogVisible,F)||(l.isNewAccountDialogVisible=F),g(F)}),c()}e&2&&(o(4),p("scrollable",!0)("value",l.accounts),o(4),p("account",l.editingAccount),f("visible",l.isNewAccountDialogVisible))},dependencies:[Z,ie,R,V,me,W,$,I],styles:[".accounts-container[_ngcontent-%COMP%]{width:100%;height:100%}.accounts-container[_ngcontent-%COMP%]   .actions-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center;gap:8px;margin-bottom:.75rem}.accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]{height:calc(100% - 1.781rem - .75rem)}.accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]     .p-datatable, .accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]     .p-datatable-wrapper{height:100%}.accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]   th.align-center[_ngcontent-%COMP%], .accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]   td.align-center[_ngcontent-%COMP%]{text-align:center}.accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]   th.align-right[_ngcontent-%COMP%], .accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]   td.align-right[_ngcontent-%COMP%]{text-align:right}.accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]   .cell-flex-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.accounts-container[_ngcontent-%COMP%]   .accounts-table-wrapper[_ngcontent-%COMP%]   .accounts-table[_ngcontent-%COMP%]   .cell-flex-wrapper[_ngcontent-%COMP%]   .p-colorpicker-preview[_ngcontent-%COMP%]{min-width:1.5rem}"]})};var Re=[{path:"",component:Y}],L=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=D({type:a});static \u0275inj=M({imports:[j.forChild(Re),j]})};var be=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=D({type:a});static \u0275inj=M({imports:[Ce,L]})};export{be as AccountsModule};
